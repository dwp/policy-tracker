{% extends prototype.current.layout %}

{% set page = {
  title: 'index',
  dev: true,
  html_classes: ['full-width']
} %}

{% block portfolio_header %}
  <div class="portfolio_header">
    <div class="grid grid--middle">
      <div class="grid__item two-thirds">
        <h1 class="heading-xlarge js-directorates-title">Portfolio Overview</h1>
      </div>
    </div>
  </div>
{% endblock %}

{% block portfolio_projects %}
  
  <h2 class="heading-large" style="margin: 0 0 20px 0">All directorates</h2>
  
  <div class="grid js-projects-grid">
      {{ portfolio.project_item({
        priority: 1,
        metadata: {
          classes: [
            'priority-1',
            'minister-1',
            'status-open',
            'type-1',
            'trigger-1'
          ]
        }
      }) }}
      {{ portfolio.project_item({
        priority: 2,
        metadata: {
          classes: [
            'priority-2',
            'minister-2',
            'status-open',
            'type-2',
            'trigger-2'
          ]
        }
      }) }}
      {{ portfolio.project_item({
        priority: 3,
        metadata: {
          classes: [
            'priority-3',
            'minister-3',
            'status-open',
            'type-3',
            'trigger-3'
          ]
        }
      }) }}
      {{ portfolio.project_item({
        priority: 4,
        metadata: {
          classes: [
            'priority-4',
            'minister-4',
            'status-open',
            'type-4',
            'trigger-4'
          ]
        }
      }) }}
      {{ portfolio.project_item({
        priority: 5,
        metadata: {
          classes: [
            'priority-5',
            'minister-5',
            'status-open',
            'type-5',
            'trigger-5'
          ]
        }
      }) }}
      {{ portfolio.project_item({
        priority: 5,
        metadata: {
          classes: [
            'priority-5',
            'minister-2',
            'status-development',
            'type-2',
            'trigger-3'
          ]
        }
      }) }}
      {{ portfolio.project_item({
        priority: 2,
        metadata: {
          classes: [
            'priority-2',
            'minister-3',
            'status-closed',
            'type-3',
            'trigger-4'
          ]
        }
      }) }}
      {{ portfolio.project_item({
        priority: 3,
        metadata: {
          classes: [
            'priority-3',
            'minister-4',
            'status-decision',
            'type-4',
            'trigger-5'
          ]
        }
      }) }}
  </div>
{% endblock %}

{% block portfolio_filters %}
  <div class="portfolio-filters">
    
    <h2 class="heading-medium" style="margin: 0 0 20px 0;">Filter the portfolio</h2>
    <p>Use the facets below to refine your view of the portfolio</p>
    
    <div class="portfolio-filters__facet">
      <label class="portfolio-filters__facet__title heading-small" style="display: block" for="facet-directorate">Directorate</label>
      <select class="form-control portfolio-filters__select js-filter-action" id="facet-directorate">
        <option value="directorate-all">All directorates</option>
        <option value="directorate-one">Directorate one</option>
        <option value="directorate-two">Directorate two</option>
        <option value="directorate-three">Directorate three</option>
        <option value="directorate-four">Directorate four</option>
        <option value="directorate-five">Directorate five</option>
      </select>
    </div>
    
    <div class="portfolio-filters__facet">
      <h3 class="portfolio-filters__facet__title heading-small">Type</h3>
      <div class="portfolio-filters__facet">
        <label for="facet-type-1">
          <input id="facet-type-1" name="types" type="checkbox" value="type-1" class="js-filter-action">
          Type label
        </label>
      </div>
      <div class="portfolio-filters__facet">
        <label for="facet-type-2">
          <input id="facet-type-2" name="types" type="checkbox" value="type-2" class="js-filter-action">
          Type label
        </label>
      </div>
      <div class="portfolio-filters__facet">
        <label for="facet-type-3">
          <input id="facet-type-3" name="types" type="checkbox" value="type-3" class="js-filter-action">
          Type label
        </label>
      </div>
    </div>
    
    <div class="portfolio-filters__facet">
      <label class="portfolio-filters__facet__title heading-small" style="display: block" for="facet-minister">Minister</label>
      <select class="form-control portfolio-filters__select js-filter-action" id="facet-minister">
        <option value="minister-all">All ministers</option>
        <option value="minister-1">First name Surname</option>
        <option value="minister-2">First name Surname</option>
        <option value="minister-3">First name Surname</option>
        <option value="minister-4">First name Surname</option>
        <option value="minister-5">First name Surname</option>
      </select>
    </div>
    
    <div class="portfolio-filters__facet">
      <label class="portfolio-filters__facet__title heading-small" style="display: block" for="facet-trigger">Trigger</label>
      <select class="form-control portfolio-filters__select js-filter-action" id="facet-trigger">
        <option value="trigger-all">All triggers</option>
        <option value="trigger-1">Trigger</option>
        <option value="trigger-2">Trigger</option>
        <option value="trigger-3">Trigger</option>
        <option value="trigger-4">Trigger</option>
      </select>
    </div>
    
    <div class="portfolio-filters__facet">
      <label class="portfolio-filters__facet__title heading-small" style="display: block" for="facet-status">Status</label>
      <select class="form-control portfolio-filters__select js-filter-action" id="facet-status">
        <option value="status-all">All statuses</option>
        <option value="status-open">Open</option>
        <option value="status-scoping">Scoping</option>
        <option value="status-resourcing">Resourcing</option>
        <option value="status-development">in development</option>
        <option value="status-decision">Awaiting decision</option>
        <option value="status-closed">Closed</option>
      </select>
    </div>
    
  </div>
{% endblock %}

{% block body_end %}
  
  <script src="{{ asset_path }}javascripts/jquery-1.11.3.js" type="text/javascript"></script>
  <script src="{{ asset_path }}javascripts/isotope.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    $(function(){
      
      var pp = {
        
        handleFilterActions: function() {
          var self = this;
          var $filterActions = $('.js-filter-action');
          var actionString;
          
          if($filterActions.length) {
            
            $filterActions.on('change', function(){
              
              actionString = '';
              
              $filterActions.each(function(i){
                var $thisFilter = $(this);
                if($thisFilter.is('input[type="checkbox"]')) {
                  if($thisFilter.is(":checked")) {
                    actionString += '.' + $thisFilter.val() ;
                  }
                } else {
                  actionString += '.' + $thisFilter.val();
                }
              });
              
              self.grid.isotope({ filter: actionString });
              
            }); 
            
          }
        },
        
        grid: $('.js-projects-grid').isotope({
          itemSelector: '.js-project-item',
          layoutMode: 'fitRows',
          percentPosition: true
        }),
        
        init: function() {
          var self = this;
          self.handleFilterActions();
        }
      }
      
      pp.init();
      
    });
  </script>
{% endblock %}